{% extends 'base.html.twig' %}

{% block title %}Coach index{% endblock %}

{% block body %}

        <h2>Summoner: {{ summoner.summonerLevel }}</h2>


    <header class="container-coach"><center><h1 title="coach-index-h1">Coach Index</h1></center></header>
    <div class ="row">
        {% for coach in coaches %}
        <aside class="profile-card">
            <header>
                <!-- here’s the avatar -->
                <br/>
                <a href="{{path('app_coach_show', { 'id': coach.id }) }}">
                    <img src="{{ asset('/coachPics/5/'~ coach.imageURL) }}" alt="Fix this dude's picture" style = "width: 100px;height: 100px">
                </a>

                <!-- the username -->
                <h1>George Darkos</h1>

                <!-- and role or location -->
                <h2> {{ coach.tier }} </h2>

            </header>

            <!-- bit of a bio; who are you? -->
            <div class="profile-bio">

                <p>Hello there!</p>
                <p>{{ coach.motto }}</p>
            </div>

            <div>
                <span></span>
                <span class="rating" data-rating="0">
                    <i class="star" data-checked="false" data-note="1">&#9733;</i>
                    <i class="star" data-checked="false" data-note="2">&#9733;</i>
                    <i class="star" data-checked="false" data-note="3">&#9733;</i>
                    <i class="star" data-checked="false" data-note="4">&#9733;</i>
                    <i class="star" data-checked="false" data-note="5">&#9733;</i>
                </span>
                <span>
                    <input class="coach-id" hidden value="{{ coach.id }}">
                </span>
            </div>

            <a href="{{ path('app_coach_edit', {'id': coach.id}) }}"><h5>edit</h5></a>

            <!-- some social links to show off -->
            <ul class="profile-social-links">

                <!-- twitter - el clásico  -->
                <li><br/><br/><br/><br/><br><br/><br>
                    <a href="https://twitter.com/tutsplus">
                        <img src="{{asset("assets/images/discord-icon-svgrepo-com.svg")}}" alt="">
                    </a>
                </li>

                <!-- envato – use this one to link to your marketplace profile -->
                <li><br/>
                    <a href="https://envato.com">
                        <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/210284/social-envato.svg" alt="">
                    </a>
                </li>

                <!-- codepen - your codepen profile-->
                <li><br/>
                    <a href="https://codepen.io/tutsplus">
                        <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/210284/social-codepen.svg" alt="">
                    </a>
                </li>

                <li><a href="{{ path('addf',{'id':coach.id}) }}">
                        <i class="far fa-heart "></i>
                    </a></li>

                <!-- add or remove social profiles as you see fit -->

            </ul>

        </aside>
        {% endfor %}

    </div>
    <a href="{{ path('app_coach_new') }}">Create new</a>

    {%  block js %}
        <script>
            const ratings = document.querySelectorAll('.rating');
            const coach_id = document.querySelector('.coach-id').value;
            ratings.forEach(rating =>
                rating.addEventListener('mouseleave', ratingHandler)
            );
            const stars = document.querySelectorAll('.rating .star');
            stars.forEach(star => {
                star.addEventListener('mouseover', starSelection);
                star.addEventListener('mouseleave', starSelection);
                star.addEventListener('click', activeSelect);
            });
            function ratingHandler(e) {
                const childStars = e.target.children;
                for(let i = 0; i < childStars.length; i++) {
                    const star = childStars.item(i)
                    if (star.dataset.checked === "true") {
                        star.classList.add('hover');
                    }
                    else {
                        star.classList.remove('hover');
                    }
                }
            }
            function starSelection(e) {
                const parent = e.target.parentElement
                const childStars = parent.children;
                const dataset = e.target.dataset;
                const note = +dataset.note; // Convert note (string) to note (number)
                for (let i = 0; i < childStars.length; i++) {
                    const star = childStars.item(i)
                    if (+star.dataset.note > note) {
                        star.classList.remove('hover');
                    } else {
                        star.classList.add('hover');
                    }
                }
            }
            function activeSelect(e) {
                const parent = e.target.parentElement
                const childStars = parent.children;
                const dataset = e.target.dataset;
                const note = +dataset.note; // Convert note (string) to note (number)
                for (let i = 0; i < childStars.length; i++) {
                    const star = childStars.item(i)
                    if (+star.dataset.note > note) {
                        star.classList.remove('hover');
                        star.dataset.checked = "false";
                    } else {
                        star.classList.add('hover');
                        star.dataset.checked = "true";
                    }
                }
                const noteTextElement = parent.parentElement.lastElementChild.children.item(0)
                noteTextElement.innerText = `Note: ${note}`;
                console.log(note);
                let url = `/coach/editRating/${coach_id}/${note}`
                window.location.href = url
                console.log(url)
            }
        </script>

    {% endblock %}
{% endblock %}
